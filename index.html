<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script>

    <title>Firebase | Contact Form</title>

    <!-- Styles -->
    <style>
        .container {
            max-width: 400px;
        }

        textarea {
            resize: none;
        }

        .alert {
            display: none;
        }
    </style>
</head>

<body class="bg-dark d-flex justify-content-center align-items-center vh-100">
    <!-- Form -->
    <form class="container bg-warning rounded mx-3 p-5" id="contactForm">
        <h1 class="text-center">Get in Touch</h1>
        <p class="mb-4 text-center fw-bold">The message you send will get stored in Firebase!</p>
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <strong>Sent!</strong>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        <!-- Name -->
        <div class="mb-3">
            <label for="name" class="form-label fw-bold">Name</label>
            <input type="text" class="form-control" id="name" name="name" placeholder="e.g. John Doe">
        </div>
        <!-- Email -->
        <div class="mb-3">
            <label for="email" class="form-label fw-bold">Email</label>
            <input type="email" class="form-control" id="email" name="email" placeholder="name@example.com">
        </div>
        <!-- Message -->
        <div class="mb-3">
            <label for="message" class="form-label fw-bold">Message</label>
            <textarea class="form-control" id="message" name="message" rows="4"
                placeholder="Type your message..."></textarea>
        </div>
        <!-- Submit -->
        <div class="d-grid">
            <button class="btn btn-dark fw-bold" type="submit">Send</button>
        </div>
    </form>

    <!-- JavaScript -->
    <script type="module">
        // Importing Firebase through CDN
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.14.0/firebase-app.js';
        import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-database.js";

        // Configuring Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyAWrFn7huN15Tp00HgVOYRbhIo1fTk7uC0",
            authDomain: "fir-form-62cc1.firebaseapp.com",
            projectId: "fir-form-62cc1",
            storageBucket: "fir-form-62cc1.appspot.com",
            messagingSenderId: "815046885552",
            appId: "1:815046885552:web:f67f284f4f476cfcffbb75"
        };

        // Initiating Firebase
        const app = initializeApp(firebaseConfig);

        // Referencing the Realtime Database
        const formDB = ref(getDatabase(app));

        // Function to Submit the Form Data 
        const form = document.querySelector('#contactForm');
        form.addEventListener('submit', (e) => {
            e.preventDefault();

            // Getting the Form Data
            let name = document.querySelector('#name').value;
            let email = document.querySelector('#email').value;
            let message = document.querySelector('#message').value;

            // Saving in Database
            saveMessages(name, email, message);

            // Triggering the Alert
            document.querySelector('.alert').style.display = 'block';

            // Reset Form
            form.reset();
        });

        // Function to Save the Form Data inside the Database
        function saveMessages(name, email, message) {
            push(formDB, {
                name: name,
                email: email,
                message, message
            });
        };
    </script>
</body>

</html>